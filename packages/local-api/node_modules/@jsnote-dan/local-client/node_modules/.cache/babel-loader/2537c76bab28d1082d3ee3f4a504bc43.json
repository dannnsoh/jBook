{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ryzen\\\\Desktop\\\\jbook\\\\src\\\\components\\\\preview.tsx\",\n    _s = $RefreshSig$();\n\nimport \"./preview.css\";\nimport { useRef, useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// setup event listener for message and eval the message (bundled code)\n// embed this as inner html in iframe using srcdoc attribute\nconst html = `\n    <html>\n        <head></head>\n        <body>\n            <div id=\"root\"></div>\n            <script>\n\t\t\t\tconst handleError = (err) => {\n\t\t\t\t\tconst root = document.getElementById(\"root\");\n\t\t\t\t\troot.innerHTML = '<div style=\"color: red;\"><h4>Runtime Error</h4>' + err + '</div>';\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t};\n\t\t\t\twindow.addEventListener(\"error\", (event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\thandleError(event.error);\n\t\t\t\t});\n                window.addEventListener(\"message\", (event) => {\n                    try {\n                        eval(event.data);\n                    } catch (err) {\n                        handleError(err);\n                    }\n                }, false)\n            </script>\n        </body>\n    </html>\n`;\n\nconst Preview = _ref => {\n  _s();\n\n  let {\n    code,\n    bundleError\n  } = _ref;\n  const iframe = useRef();\n  useEffect(() => {\n    // update srcdoc of iframe to default state to prevent user from deleting html structure by any chance\n    iframe.current.srcdoc = html; // slightly delay to allow update of srcdoc first\n\n    setTimeout(() => {\n      // pass bundled code into iframe element via a ref\n      if (iframe.current.contentWindow) {\n        iframe.current.contentWindow.postMessage(code, \"*\");\n      }\n    }, 50);\n  }, [code]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"preview-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"iframe\", {\n      title: \"code preview\",\n      ref: iframe,\n      sandbox: \"allow-scripts\",\n      srcDoc: html\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 4\n    }, this), bundleError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"preview-error\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Compilation Error\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 6\n      }, this), bundleError]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Preview, \"GAFleWBZ6O+8Op7dBuDH6PzOglQ=\");\n\n_c = Preview;\nexport default Preview;\n\nvar _c;\n\n$RefreshReg$(_c, \"Preview\");","map":{"version":3,"sources":["C:/Users/Ryzen/Desktop/jbook/src/components/preview.tsx"],"names":["useRef","useEffect","html","Preview","code","bundleError","iframe","current","srcdoc","setTimeout","contentWindow","postMessage"],"mappings":";;;AAAA,OAAO,eAAP;AACA,SAASA,MAAT,EAAiBC,SAAjB,QAAkC,OAAlC;;AAOA;AACA;AACA,MAAMC,IAAI,GAAI;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAzBA;;AA2BA,MAAMC,OAAO,GAAG,QAAyC;AAAA;;AAAA,MAAxC;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,GAAwC;AACxD,QAAMC,MAAM,GAAGN,MAAM,EAArB;AAEAC,EAAAA,SAAS,CACR,MAAM;AACL;AACAK,IAAAA,MAAM,CAACC,OAAP,CAAeC,MAAf,GAAwBN,IAAxB,CAFK,CAGL;;AACAO,IAAAA,UAAU,CAAC,MAAM;AAChB;AACA,UAAIH,MAAM,CAACC,OAAP,CAAeG,aAAnB,EAAkC;AACjCJ,QAAAA,MAAM,CAACC,OAAP,CAAeG,aAAf,CAA6BC,WAA7B,CAAyCP,IAAzC,EAA+C,GAA/C;AACA;AACD,KALS,EAKP,EALO,CAAV;AAMA,GAXO,EAYR,CAAEA,IAAF,CAZQ,CAAT;AAeA,sBACC;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA,4BACC;AAAQ,MAAA,KAAK,EAAC,cAAd;AAA6B,MAAA,GAAG,EAAEE,MAAlC;AAA0C,MAAA,OAAO,EAAC,eAAlD;AAAkE,MAAA,MAAM,EAAEJ;AAA1E;AAAA;AAAA;AAAA;AAAA,YADD,EAEEG,WAAW,iBACX;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA,8BACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADD,EAEEA,WAFF;AAAA;AAAA;AAAA;AAAA;AAAA,YAHF;AAAA;AAAA;AAAA;AAAA;AAAA,UADD;AAWA,CA7BD;;GAAMF,O;;KAAAA,O;AA+BN,eAAeA,OAAf","sourcesContent":["import \"./preview.css\";\r\nimport { useRef, useEffect } from \"react\";\r\n\r\ninterface PreviewProps {\r\n\tcode: string;\r\n\tbundleError: string;\r\n}\r\n\r\n// setup event listener for message and eval the message (bundled code)\r\n// embed this as inner html in iframe using srcdoc attribute\r\nconst html = `\r\n    <html>\r\n        <head></head>\r\n        <body>\r\n            <div id=\"root\"></div>\r\n            <script>\r\n\t\t\t\tconst handleError = (err) => {\r\n\t\t\t\t\tconst root = document.getElementById(\"root\");\r\n\t\t\t\t\troot.innerHTML = '<div style=\"color: red;\"><h4>Runtime Error</h4>' + err + '</div>';\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t};\r\n\t\t\t\twindow.addEventListener(\"error\", (event) => {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\thandleError(event.error);\r\n\t\t\t\t});\r\n                window.addEventListener(\"message\", (event) => {\r\n                    try {\r\n                        eval(event.data);\r\n                    } catch (err) {\r\n                        handleError(err);\r\n                    }\r\n                }, false)\r\n            </script>\r\n        </body>\r\n    </html>\r\n`;\r\n\r\nconst Preview = ({ code, bundleError }: PreviewProps) => {\r\n\tconst iframe = useRef<any>();\r\n\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\t// update srcdoc of iframe to default state to prevent user from deleting html structure by any chance\r\n\t\t\tiframe.current.srcdoc = html;\r\n\t\t\t// slightly delay to allow update of srcdoc first\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t// pass bundled code into iframe element via a ref\r\n\t\t\t\tif (iframe.current.contentWindow) {\r\n\t\t\t\t\tiframe.current.contentWindow.postMessage(code, \"*\");\r\n\t\t\t\t}\r\n\t\t\t}, 50);\r\n\t\t},\r\n\t\t[ code ]\r\n\t);\r\n\r\n\treturn (\r\n\t\t<div className=\"preview-wrapper\">\r\n\t\t\t<iframe title=\"code preview\" ref={iframe} sandbox=\"allow-scripts\" srcDoc={html} />\r\n\t\t\t{bundleError && (\r\n\t\t\t\t<div className=\"preview-error\">\r\n\t\t\t\t\t<h3>Compilation Error</h3>\r\n\t\t\t\t\t{bundleError}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Preview;\r\n"]},"metadata":{},"sourceType":"module"}