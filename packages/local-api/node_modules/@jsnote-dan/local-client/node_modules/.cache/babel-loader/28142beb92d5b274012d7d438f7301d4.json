{"ast":null,"code":"/**\n * @typedef {import('./types.js').Rule} Rule\n * @typedef {import('./types.js').RulePseudo} RulePseudo\n * @typedef {import('./types.js').RulePseudoNth} RulePseudoNth\n * @typedef {import('./types.js').RulePseudoSelector} RulePseudoSelector\n * @typedef {import('./types.js').Parent} Parent\n * @typedef {import('./types.js').Selector} Selector\n * @typedef {import('./types.js').Selectors} Selectors\n * @typedef {import('./types.js').SelectState} SelectState\n * @typedef {import('./types.js').Element} Element\n * @typedef {import('./types.js').ElementChild} ElementChild\n */\nimport { extendedFilter } from 'bcp-47-match';\nimport { parse as commas } from 'comma-separated-tokens';\nimport { hasProperty } from 'hast-util-has-property';\nimport { isElement } from 'hast-util-is-element';\nimport { whitespace } from 'hast-util-whitespace';\nimport { zwitch } from 'zwitch';\nimport { any } from './any.js';\nconst handle = zwitch('name', {\n  // @ts-expect-error: hush.\n  unknown: unknownPseudo,\n  invalid: invalidPseudo,\n  handlers: {\n    // @ts-expect-error: hush.\n    any: matches,\n    // @ts-expect-error: hush.\n    'any-link': anyLink,\n    // @ts-expect-error: hush.\n    blank,\n    // @ts-expect-error: hush.\n    checked,\n    // @ts-expect-error: hush.\n    dir,\n    // @ts-expect-error: hush.\n    disabled,\n    // @ts-expect-error: hush.\n    empty,\n    // @ts-expect-error: hush.\n    enabled,\n    // @ts-expect-error: hush.\n    'first-child': firstChild,\n    // @ts-expect-error: hush.\n    'first-of-type': firstOfType,\n    // @ts-expect-error: hush.\n    has,\n    // @ts-expect-error: hush.\n    lang,\n    // @ts-expect-error: hush.\n    'last-child': lastChild,\n    // @ts-expect-error: hush.\n    'last-of-type': lastOfType,\n    // @ts-expect-error: hush.\n    matches,\n    // @ts-expect-error: hush.\n    not,\n    // @ts-expect-error: hush.\n    'nth-child': nthChild,\n    // @ts-expect-error: hush.\n    'nth-last-child': nthLastChild,\n    // @ts-expect-error: hush.\n    'nth-of-type': nthOfType,\n    // @ts-expect-error: hush.\n    'nth-last-of-type': nthLastOfType,\n    // @ts-expect-error: hush.\n    'only-child': onlyChild,\n    // @ts-expect-error: hush.\n    'only-of-type': onlyOfType,\n    // @ts-expect-error: hush.\n    optional,\n    // @ts-expect-error: hush.\n    'read-only': readOnly,\n    // @ts-expect-error: hush.\n    'read-write': readWrite,\n    // @ts-expect-error: hush.\n    required,\n    // @ts-expect-error: hush.\n    root,\n    // @ts-expect-error: hush.\n    scope\n  }\n});\npseudo.needsIndex = ['first-child', 'first-of-type', 'last-child', 'last-of-type', 'nth-child', 'nth-last-child', 'nth-of-type', 'nth-last-of-type', 'only-child', 'only-of-type'];\n/**\n * @param {Rule} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\n\nexport function pseudo(query, element, index, parent, state) {\n  const pseudos = query.pseudos;\n  let offset = -1;\n\n  while (++offset < pseudos.length) {\n    if (!handle(pseudos[offset], element, index, parent, state)) return false;\n  }\n\n  return true;\n}\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\n\nfunction matches(query, element, _1, _2, state) {\n  const shallow = state.shallow;\n  const one = state.one;\n  state.shallow = true;\n  state.one = true;\n  const result = any(query.value, element, state)[0] === element;\n  state.shallow = shallow;\n  state.one = one;\n  return result;\n}\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction not(query, element, index, parent, state) {\n  return !matches(query, element, index, parent, state);\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction anyLink(_, element) {\n  return isElement(element, ['a', 'area', 'link']) && hasProperty(element, 'href');\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction checked(_, element) {\n  if (isElement(element, ['input', 'menuitem'])) {\n    return Boolean(element.properties && (element.properties.type === 'checkbox' || element.properties.type === 'radio') && hasProperty(element, 'checked'));\n  }\n\n  if (isElement(element, 'option')) {\n    return hasProperty(element, 'selected');\n  }\n\n  return false;\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction dir(query, _1, _2, _3, state) {\n  return state.direction === query.value;\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction disabled(_, element) {\n  return isElement(element, ['button', 'input', 'select', 'textarea', 'optgroup', 'option', 'menuitem', 'fieldset']) && hasProperty(element, 'disabled');\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction enabled(query, element) {\n  return !disabled(query, element);\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction required(_, element) {\n  return isElement(element, ['input', 'textarea', 'select']) && hasProperty(element, 'required');\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction optional(query, element) {\n  return !required(query, element);\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction readWrite(_, element, _1, _2, state) {\n  return isElement(element, ['input', 'textarea']) ? !hasProperty(element, 'readOnly') && !hasProperty(element, 'disabled') : Boolean(state.editableOrEditingHost);\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction readOnly(query, element, index, parent, state) {\n  return !readWrite(query, element, index, parent, state);\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction root(_, element, _1, parent, state) {\n  return Boolean((!parent || parent.type === 'root') && state.schema && (state.schema.space === 'html' || state.schema.space === 'svg') && isElement(element, ['html', 'svg']));\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction scope(_, element, _1, _2, state) {\n  return Boolean(isElement(element) && state.scopeElements && state.scopeElements.includes(element));\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction empty(_, element) {\n  return !someChildren(element, check);\n  /**\n   * @param {ElementChild} child\n   * @returns {boolean}\n   */\n\n  function check(child) {\n    return child.type === 'element' || child.type === 'text';\n  }\n}\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\n\n\nfunction blank(_, element) {\n  return !someChildren(element, check);\n  /**\n   * @param {ElementChild} child\n   * @returns {boolean}\n   */\n\n  function check(child) {\n    return child.type === 'element' || child.type === 'text' && !whitespace(child);\n  }\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction firstChild(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return state.elementIndex === 0;\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction lang(query, _1, _2, _3, state) {\n  return state.language !== '' && state.language !== undefined && state.language !== null && // @ts-expect-error never `selectors`.\n  extendedFilter(state.language, commas(query.value)).length > 0;\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction lastChild(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return Boolean(state.elementCount && state.elementIndex === state.elementCount - 1);\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction onlyChild(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return state.elementCount === 1;\n}\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction nthChild(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return typeof state.elementIndex === 'number' && query.value(state.elementIndex);\n}\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction nthLastChild(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return Boolean(typeof state.elementCount === 'number' && typeof state.elementIndex === 'number' && query.value(state.elementCount - state.elementIndex - 1));\n}\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction nthOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return typeof state.typeIndex === 'number' && query.value(state.typeIndex);\n}\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction nthLastOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return typeof state.typeCount === 'number' && typeof state.typeIndex === 'number' && query.value(state.typeCount - 1 - state.typeIndex);\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction firstOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return state.typeIndex === 0;\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction lastOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return typeof state.typeIndex === 'number' && typeof state.typeCount === 'number' && state.typeIndex === state.typeCount - 1;\n}\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction onlyOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query);\n  return state.typeCount === 1;\n}\n/**\n * @param {Element} element\n * @param {(child: ElementChild) => boolean} check\n * @returns {boolean}\n */\n\n\nfunction someChildren(element, check) {\n  const children = element.children;\n  let index = -1;\n\n  while (++index < children.length) {\n    if (check(children[index])) return true;\n  }\n\n  return false;\n} // Shouldn’t be called, parser gives correct data.\n\n/* c8 ignore next 3 */\n\n\nfunction invalidPseudo() {\n  throw new Error('Invalid pseudo-selector');\n}\n/**\n * @param {RulePseudo} query\n */\n\n\nfunction unknownPseudo(query) {\n  if (query.name) {\n    throw new Error('Unknown pseudo-selector `' + query.name + '`');\n  }\n\n  throw new Error('Unexpected pseudo-element or empty pseudo-class');\n}\n/**\n * @param {SelectState} state\n * @param {RulePseudo|RulePseudoNth} query\n */\n\n\nfunction assertDeep(state, query) {\n  if (state.shallow) {\n    throw new Error('Cannot use `:' + query.name + '` without parent');\n  }\n}\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\n\n\nfunction has(query, element, _2, _3, state) {\n  const shallow = state.shallow;\n  const one = state.one;\n  const scopeElements = state.scopeElements;\n  const value = appendScope(query.value);\n  state.shallow = false;\n  state.one = true;\n  state.scopeElements = [element];\n  const result = any(value, element, state).length > 0;\n  state.shallow = shallow;\n  state.one = one;\n  state.scopeElements = scopeElements;\n  return result;\n}\n/**\n * @param {Selector} value\n * @returns {Selectors}\n */\n\n\nfunction appendScope(value) {\n  /** @type {Selectors} */\n  const selector = value.type === 'ruleSet' ? {\n    type: 'selectors',\n    selectors: [value]\n  } : value;\n  let index = -1;\n\n  while (++index < selector.selectors.length) {\n    const rule = selector.selectors[index].rule;\n    rule.nestingOperator = null;\n\n    if (!rule.pseudos || rule.pseudos.length !== 1 || rule.pseudos[0].name !== 'scope') {\n      selector.selectors[index] = {\n        type: 'ruleSet',\n        // @ts-expect-error pseudos are fine w/ just a name!\n        rule: {\n          type: 'rule',\n          rule,\n          pseudos: [{\n            name: 'scope'\n          }]\n        }\n      };\n    }\n  }\n\n  return selector;\n}","map":{"version":3,"sources":["C:/Users/Ryzen/Desktop/jbook/node_modules/hast-util-select/lib/pseudo.js"],"names":["extendedFilter","parse","commas","hasProperty","isElement","whitespace","zwitch","any","handle","unknown","unknownPseudo","invalid","invalidPseudo","handlers","matches","anyLink","blank","checked","dir","disabled","empty","enabled","firstChild","firstOfType","has","lang","lastChild","lastOfType","not","nthChild","nthLastChild","nthOfType","nthLastOfType","onlyChild","onlyOfType","optional","readOnly","readWrite","required","root","scope","pseudo","needsIndex","query","element","index","parent","state","pseudos","offset","length","_1","_2","shallow","one","result","value","_","Boolean","properties","type","_3","direction","editableOrEditingHost","schema","space","scopeElements","includes","someChildren","check","child","assertDeep","elementIndex","language","undefined","elementCount","typeIndex","typeCount","children","Error","name","appendScope","selector","selectors","rule","nestingOperator"],"mappings":"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","sourcesContent":["/**\n * @typedef {import('./types.js').Rule} Rule\n * @typedef {import('./types.js').RulePseudo} RulePseudo\n * @typedef {import('./types.js').RulePseudoNth} RulePseudoNth\n * @typedef {import('./types.js').RulePseudoSelector} RulePseudoSelector\n * @typedef {import('./types.js').Parent} Parent\n * @typedef {import('./types.js').Selector} Selector\n * @typedef {import('./types.js').Selectors} Selectors\n * @typedef {import('./types.js').SelectState} SelectState\n * @typedef {import('./types.js').Element} Element\n * @typedef {import('./types.js').ElementChild} ElementChild\n */\n\nimport {extendedFilter} from 'bcp-47-match'\nimport {parse as commas} from 'comma-separated-tokens'\nimport {hasProperty} from 'hast-util-has-property'\nimport {isElement} from 'hast-util-is-element'\nimport {whitespace} from 'hast-util-whitespace'\nimport {zwitch} from 'zwitch'\nimport {any} from './any.js'\n\nconst handle = zwitch('name', {\n  // @ts-expect-error: hush.\n  unknown: unknownPseudo,\n  invalid: invalidPseudo,\n  handlers: {\n    // @ts-expect-error: hush.\n    any: matches,\n    // @ts-expect-error: hush.\n    'any-link': anyLink,\n    // @ts-expect-error: hush.\n    blank,\n    // @ts-expect-error: hush.\n    checked,\n    // @ts-expect-error: hush.\n    dir,\n    // @ts-expect-error: hush.\n    disabled,\n    // @ts-expect-error: hush.\n    empty,\n    // @ts-expect-error: hush.\n    enabled,\n    // @ts-expect-error: hush.\n    'first-child': firstChild,\n    // @ts-expect-error: hush.\n    'first-of-type': firstOfType,\n    // @ts-expect-error: hush.\n    has,\n    // @ts-expect-error: hush.\n    lang,\n    // @ts-expect-error: hush.\n    'last-child': lastChild,\n    // @ts-expect-error: hush.\n    'last-of-type': lastOfType,\n    // @ts-expect-error: hush.\n    matches,\n    // @ts-expect-error: hush.\n    not,\n    // @ts-expect-error: hush.\n    'nth-child': nthChild,\n    // @ts-expect-error: hush.\n    'nth-last-child': nthLastChild,\n    // @ts-expect-error: hush.\n    'nth-of-type': nthOfType,\n    // @ts-expect-error: hush.\n    'nth-last-of-type': nthLastOfType,\n    // @ts-expect-error: hush.\n    'only-child': onlyChild,\n    // @ts-expect-error: hush.\n    'only-of-type': onlyOfType,\n    // @ts-expect-error: hush.\n    optional,\n    // @ts-expect-error: hush.\n    'read-only': readOnly,\n    // @ts-expect-error: hush.\n    'read-write': readWrite,\n    // @ts-expect-error: hush.\n    required,\n    // @ts-expect-error: hush.\n    root,\n    // @ts-expect-error: hush.\n    scope\n  }\n})\n\npseudo.needsIndex = [\n  'first-child',\n  'first-of-type',\n  'last-child',\n  'last-of-type',\n  'nth-child',\n  'nth-last-child',\n  'nth-of-type',\n  'nth-last-of-type',\n  'only-child',\n  'only-of-type'\n]\n\n/**\n * @param {Rule} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\nexport function pseudo(query, element, index, parent, state) {\n  const pseudos = query.pseudos\n  let offset = -1\n\n  while (++offset < pseudos.length) {\n    if (!handle(pseudos[offset], element, index, parent, state)) return false\n  }\n\n  return true\n}\n\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction matches(query, element, _1, _2, state) {\n  const shallow = state.shallow\n  const one = state.one\n\n  state.shallow = true\n  state.one = true\n\n  const result = any(query.value, element, state)[0] === element\n\n  state.shallow = shallow\n  state.one = one\n\n  return result\n}\n\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction not(query, element, index, parent, state) {\n  return !matches(query, element, index, parent, state)\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction anyLink(_, element) {\n  return (\n    isElement(element, ['a', 'area', 'link']) && hasProperty(element, 'href')\n  )\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction checked(_, element) {\n  if (isElement(element, ['input', 'menuitem'])) {\n    return Boolean(\n      element.properties &&\n        (element.properties.type === 'checkbox' ||\n          element.properties.type === 'radio') &&\n        hasProperty(element, 'checked')\n    )\n  }\n\n  if (isElement(element, 'option')) {\n    return hasProperty(element, 'selected')\n  }\n\n  return false\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction dir(query, _1, _2, _3, state) {\n  return state.direction === query.value\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction disabled(_, element) {\n  return (\n    isElement(element, [\n      'button',\n      'input',\n      'select',\n      'textarea',\n      'optgroup',\n      'option',\n      'menuitem',\n      'fieldset'\n    ]) && hasProperty(element, 'disabled')\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @returns {boolean}\n */\nfunction enabled(query, element) {\n  return !disabled(query, element)\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction required(_, element) {\n  return (\n    isElement(element, ['input', 'textarea', 'select']) &&\n    hasProperty(element, 'required')\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @returns {boolean}\n */\nfunction optional(query, element) {\n  return !required(query, element)\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction readWrite(_, element, _1, _2, state) {\n  return isElement(element, ['input', 'textarea'])\n    ? !hasProperty(element, 'readOnly') && !hasProperty(element, 'disabled')\n    : Boolean(state.editableOrEditingHost)\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} element\n * @param {number|null} index\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction readOnly(query, element, index, parent, state) {\n  return !readWrite(query, element, index, parent, state)\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} parent\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction root(_, element, _1, parent, state) {\n  return Boolean(\n    (!parent || parent.type === 'root') &&\n      state.schema &&\n      (state.schema.space === 'html' || state.schema.space === 'svg') &&\n      isElement(element, ['html', 'svg'])\n  )\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @param {number|null} _1\n * @param {Parent|null} _2\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction scope(_, element, _1, _2, state) {\n  return Boolean(\n    isElement(element) &&\n      state.scopeElements &&\n      state.scopeElements.includes(element)\n  )\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction empty(_, element) {\n  return !someChildren(element, check)\n\n  /**\n   * @param {ElementChild} child\n   * @returns {boolean}\n   */\n  function check(child) {\n    return child.type === 'element' || child.type === 'text'\n  }\n}\n\n/**\n * @param {RulePseudo} _\n * @param {Element} element\n * @returns {boolean}\n */\nfunction blank(_, element) {\n  return !someChildren(element, check)\n\n  /**\n   * @param {ElementChild} child\n   * @returns {boolean}\n   */\n  function check(child) {\n    return (\n      child.type === 'element' || (child.type === 'text' && !whitespace(child))\n    )\n  }\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction firstChild(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return state.elementIndex === 0\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction lang(query, _1, _2, _3, state) {\n  return (\n    state.language !== '' &&\n    state.language !== undefined &&\n    state.language !== null &&\n    // @ts-expect-error never `selectors`.\n    extendedFilter(state.language, commas(query.value)).length > 0\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction lastChild(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return Boolean(\n    state.elementCount && state.elementIndex === state.elementCount - 1\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction onlyChild(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return state.elementCount === 1\n}\n\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction nthChild(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return (\n    typeof state.elementIndex === 'number' && query.value(state.elementIndex)\n  )\n}\n\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction nthLastChild(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return Boolean(\n    typeof state.elementCount === 'number' &&\n      typeof state.elementIndex === 'number' &&\n      query.value(state.elementCount - state.elementIndex - 1)\n  )\n}\n\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction nthOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return typeof state.typeIndex === 'number' && query.value(state.typeIndex)\n}\n\n/**\n * @param {RulePseudoNth} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction nthLastOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return (\n    typeof state.typeCount === 'number' &&\n    typeof state.typeIndex === 'number' &&\n    query.value(state.typeCount - 1 - state.typeIndex)\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction firstOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return state.typeIndex === 0\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction lastOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return (\n    typeof state.typeIndex === 'number' &&\n    typeof state.typeCount === 'number' &&\n    state.typeIndex === state.typeCount - 1\n  )\n}\n\n/**\n * @param {RulePseudo} query\n * @param {Element} _1\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction onlyOfType(query, _1, _2, _3, state) {\n  assertDeep(state, query)\n  return state.typeCount === 1\n}\n\n/**\n * @param {Element} element\n * @param {(child: ElementChild) => boolean} check\n * @returns {boolean}\n */\nfunction someChildren(element, check) {\n  const children = element.children\n  let index = -1\n\n  while (++index < children.length) {\n    if (check(children[index])) return true\n  }\n\n  return false\n}\n\n// Shouldn’t be called, parser gives correct data.\n/* c8 ignore next 3 */\nfunction invalidPseudo() {\n  throw new Error('Invalid pseudo-selector')\n}\n\n/**\n * @param {RulePseudo} query\n */\nfunction unknownPseudo(query) {\n  if (query.name) {\n    throw new Error('Unknown pseudo-selector `' + query.name + '`')\n  }\n\n  throw new Error('Unexpected pseudo-element or empty pseudo-class')\n}\n\n/**\n * @param {SelectState} state\n * @param {RulePseudo|RulePseudoNth} query\n */\nfunction assertDeep(state, query) {\n  if (state.shallow) {\n    throw new Error('Cannot use `:' + query.name + '` without parent')\n  }\n}\n\n/**\n * @param {RulePseudoSelector} query\n * @param {Element} element\n * @param {number|null} _2\n * @param {Parent|null} _3\n * @param {SelectState} state\n * @returns {boolean}\n */\nfunction has(query, element, _2, _3, state) {\n  const shallow = state.shallow\n  const one = state.one\n  const scopeElements = state.scopeElements\n  const value = appendScope(query.value)\n\n  state.shallow = false\n  state.one = true\n  state.scopeElements = [element]\n\n  const result = any(value, element, state).length > 0\n\n  state.shallow = shallow\n  state.one = one\n  state.scopeElements = scopeElements\n\n  return result\n}\n\n/**\n * @param {Selector} value\n * @returns {Selectors}\n */\nfunction appendScope(value) {\n  /** @type {Selectors} */\n  const selector =\n    value.type === 'ruleSet' ? {type: 'selectors', selectors: [value]} : value\n  let index = -1\n\n  while (++index < selector.selectors.length) {\n    const rule = selector.selectors[index].rule\n    rule.nestingOperator = null\n\n    if (\n      !rule.pseudos ||\n      rule.pseudos.length !== 1 ||\n      rule.pseudos[0].name !== 'scope'\n    ) {\n      selector.selectors[index] = {\n        type: 'ruleSet',\n        // @ts-expect-error pseudos are fine w/ just a name!\n        rule: {type: 'rule', rule, pseudos: [{name: 'scope'}]}\n      }\n    }\n  }\n\n  return selector\n}\n"]},"metadata":{},"sourceType":"module"}